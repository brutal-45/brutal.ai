<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrutalFlix | Debug Mode</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-purple: #2e1065; --deep-bg: #0f021a; --card-bg: #1a0b2e;
            --electric-red: #ff003c; --neon-blue: #00f3ff; --text-white: #ffffff;
            --text-gray: #a0a0a0;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Outfit', sans-serif;
            background: linear-gradient(135deg, var(--deep-bg) 0%, #000000 100%);
            color: var(--text-white); min-height: 100vh;
        }
        .navbar {
            position: fixed; top: 0; width: 100%; height: 70px;
            background: rgba(15, 2, 26, 0.95); display: flex; align-items: center; justify-content: space-between;
            padding: 0 4%; z-index: 1000; border-bottom: 1px solid #333;
        }
        .logo { font-size: 1.5rem; font-weight: 800; color: white; }
        .logo span { color: var(--electric-red); }
        
        .search-box {
            background: #333; border-radius: 20px; padding: 8px 15px;
            display: flex; align-items: center;
        }
        .search-input {
            background: transparent; border: none; color: white; outline: none; width: 200px;
        }
        .search-btn { background: none; border: none; color: var(--neon-blue); cursor: pointer; }

        .hero {
            height: 50vh; display: flex; align-items: center; justify-content: center;
            background: radial-gradient(circle at center, #2e1065 0%, #000 100%);
            text-align: center; margin-bottom: 20px;
        }
        .hero h1 { font-size: 3rem; margin-bottom: 10px; }

        .container { padding: 20px 4%; max-width: 1400px; margin: 0 auto; }
        
        h2 { margin-bottom: 20px; border-left: 4px solid var(--neon-blue); padding-left: 10px; }

        .grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px;
            margin-bottom: 50px;
        }

        .card {
            background: var(--card-bg); border-radius: 8px; overflow: hidden; transition: 0.3s;
            cursor: pointer; position: relative;
        }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 243, 255, 0.2); }
        .card img { width: 100%; height: 270px; object-fit: cover; }
        .card-info { padding: 10px; }
        .card-title { font-weight: bold; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .card-meta { display: flex; justify-content: space-between; font-size: 0.8rem; color: #888; margin-top: 5px; }

        /* Error Box */
        #error-log {
            background: #330000; color: #ffcccc; padding: 20px; margin: 20px 4%;
            border: 1px solid red; display: none; font-family: monospace;
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="logo">Brutal<span>Flix</span></div>
        <div class="search-box">
            <input type="text" id="searchInput" class="search-input" placeholder="Search...">
            <button class="search-btn" onclick="doSearch()">üîç</button>
        </div>
    </nav>

    <div class="hero">
        <div>
            <h1>Cinema Redefined</h1>
            <p style="color: #aaa">Loading Real-Time Data...</p>
        </div>
    </div>

    <!-- Error Box to help debug -->
    <div id="error-log"></div>

    <div class="container" id="main-content">
        <!-- Categories will load here -->
    </div>

    <script>
        // ==========================================
        // 1. SETUP
        // ==========================================
        
        // üëâüëâüëâ PASTE YOUR KEY EXACTLY HERE BETWEEN THE QUOTES üëàüëàüëà
        const MY_API_KEY = "b4ff1551b6msh3b8aee841a164c1p196fe2jsnf2a1eb259445"; 
        
        const API_HOST = "streaming-availability.p.rapidapi.com";

        // ==========================================
        // 2. FETCHING
        // ==========================================

        async function getData(url) {
            const options = {
                method: 'GET',
                headers: {
                    'x-rapidapi-key': b4ff1551b6msh3b8aee841a164c1p196fe2jsnf2a1eb259445,
                    'x-rapidapi-host': streaming-availability.p.rapidapi.com
                }
            };

            try {
                const response = await fetch(url, options);
                console.log("Status:", response.status); // Check status in browser console (F12)

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API Error ${response.status}: ${errorText}`);
                }
                return await response.json();
            } catch (error) {
                showError(error.message);
                return null;
            }
        }

        async function loadCategory(title, params) {
            const baseUrl = "https://streaming-availability.p.rapidapi.com/v2/search/basic";
            const url = `${baseUrl}?${new URLSearchParams(params)}`;
            
            const data = await getData(url);
            if (!data || !data.results) return;

            renderSection(title, data.results);
        }

        async function doSearch() {
            const query = document.getElementById('searchInput').value;
            if(!query) return;
            
            document.getElementById('main-content').innerHTML = '';
            const params = {
                country: 'us',
                title: query,
                show_type: 'movie',
                order_by: 'relevance'
            };
            await loadCategory(`Search: "${query}"`, params);
        }

        // ==========================================
        // 3. RENDERING
        // ==========================================

        function renderSection(title, movies) {
            const container = document.getElementById('main-content');
            
            const section = document.createElement('div');
            section.innerHTML = `<h2>${title}</h2>`;
            
            const grid = document.createElement('div');
            grid.className = 'grid';

            // Limit to 12 movies to save space
            movies.slice(0, 12).forEach(m => {
                const poster = m.posterPath 
                    ? `https://image.tmdb.org/t/p/w500${m.posterPath}` 
                    : `https://picsum.photos/seed/${m.id}/300/450`;
                
                const year = m.year || "N/A";
                const rating = m.imdbRating ? `‚òÖ ${m.imdbRating}` : "N/A";

                grid.innerHTML += `
                    <div class="card" onclick="alert('Clicked: ${m.title}')">
                        <img src="${poster}" alt="${m.title}" loading="lazy">
                        <div class="card-info">
                            <div class="card-title">${m.title}</div>
                            <div class="card-meta">
                                <span>${year}</span>
                                <span>${rating}</span>
                            </div>
                        </div>
                    </div>
                `;
            });

            section.appendChild(grid);
            container.appendChild(section);
        }

        function showError(msg) {
            const errBox = document.getElementById('error-log');
            errBox.style.display = 'block';
            errBox.innerHTML = `<strong>Connection Failed:</strong><br>${msg}<br><br>
            <em>Common Fixes:</em><br>
            1. Did you paste the key correctly in the code?<br>
            2. Did you subscribe to the "Streaming Availability" API on RapidAPI?<br>
            3. Check the Console (F12) for more details.`;
        }

        // ==========================================
        // 4. INITIALIZE
        // ==========================================

        async function init() {
            if (MY_API_KEY === "YOUR_API_KEY") {
                showError("You forgot to paste your API Key in the code! Open the HTML file and edit line 267.");
                return;
            }

            const commonParams = { country: 'us', show_type: 'movie', output_language: 'en' };
            
            // Load a few categories
            await loadCategory("Trending Movies", { ...commonParams, order_by: 'popularity' });
            await loadCategory("Top Rated", { ...commonParams, order_by: 'imdb_rating' });
            await loadCategory("Action", { ...commonParams, genres: '28' });
        }

        // Run on load
        init();

    </script>
</body>
</html>

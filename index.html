<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BRUTALTOOLS - Ultimate PDF App</title>
    
    <!-- PWA / FAVICON ICON (Using your design) -->
    <!-- Note: In a real compiled app, this would be a .png file. Here we use the HTML directly. -->
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4aWR0aD0iMTIwMCIgaGVpZ2h0IjEwIiB2llZ2h0IjEwIiBmaWxsPSJub25zZXJvIjoxLjAiPjxyZWN0IHdpZHRoPSI1MDAiIGhlaWdodD0iMTAwIiBmaWxsPSJub256ZXJvIjEuMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0ibm9uZXJvIjEuMCIgcng9IjU1YzU4ZThmNzEzIiBmaWxsPSJub256ZXJvIjEuMCI+PHR4eHQgeD0iNTAiIHk9IjUwIiBmb250LWZhbWlseT0JhcGh1ciBmb250LXdlaWdodD03MDAiIGZvbnRzdHlsZT0iMTAwIiBmaWxsPSJub256ZXJvIjEuMCIgZmlsbD0ibm9uZXJvIjEuMCIgY3g9IjcwIiBjeT0iNTAiIGZvbnQtZmFtaWx5PSJBcmlhbCI+PC9UZXh0Pjwvc3ZnPg==">
    
    <!-- Embedded PWA Manifest -->
    <link rel="manifest" href='data:application/manifest+json;base64,ewogICJuYW1lIjogIkJSVVRBTFRPT0xTIiwKICAic2hvcnRfbmFtZSI6ICJCcnV0YWxUb29scyIsCiAgInN0YXJ0X3VybCI6ICIuIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjZjlmYWZiIiwKICAidGhlbWVfY29xvciI6ICIjNkEwREFEIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiaHR0cHM6Ly9waWNzdW0ucGhvdG9zL3NlZWQvYnJ1dGFsdG9vbHMvMTkyLzE5MiIsCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICAgInR5cGUiOiAiaW1hZ2UvanBnIgogICAgfQogIF0KfQ=='>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Libraries -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>

    <style>
        :root {
            --primary: #6A0DAD;
            --primary-dark: #4b0082;
            --primary-light: #9d4edd;
            --bg-dark: #1e1b2e;
            --bg-panel: #2a2438;
            --text-white: #ffffff;
            --text-gray: #a0a0b0;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-white);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- CUSTOM ICON STYLING (Adapted from your code) --- */
        .brand-container {
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        /* Small version for Header */
        .brand-icon-sm {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(145deg, #7a1cff, #5a0db5);
            box-shadow: 0 5px 15px rgba(90,13,181,0.4);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            position: relative;
        }
        .brand-icon-sm .icon-box { display: flex; justify-content: center; align-items: center; }
        .brand-icon-sm .icon-text { 
            background: white; 
            color: #6a0dad; 
            padding: 1px 4px; 
            border-radius: 4px; 
            font-weight: 800; 
            font-size: 8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .brand-icon-sm:hover { transform: scale(1.05); }

        /* Large version for Landing Page */
        .brand-icon-lg {
            width: 220px;
            height: 220px;
            border-radius: 40px;
            background: linear-gradient(145deg, #7a1cff, #5a0db5);
            box-shadow: 0 25px 50px rgba(90,13,181,.4);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            margin: 0 auto;
        }
        .brand-icon-lg .icon-box { display: flex; justify-content: center; align-items: center; margin-bottom: 10px; }
        .brand-icon-lg .icon-text {
            background: white;
            color: #6a0dad;
            padding: 10px 18px;
            border-radius: 16px;
            font-weight: 800;
            font-size: 32px;
            box-shadow: 0 10px 20px rgba(0,0,0,.15);
        }
        .brand-name { margin-top: 14px; font-size: 22px; letter-spacing: 1px; font-weight: 800; text-align: center; }
        .tagline { font-size: 12px; opacity: .9; text-align: center; }

        /* --- HEADER --- */
        .app-header {
            height: 70px;
            background-color: var(--bg-panel);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        /* --- LAYOUT --- */
        .app-container { display: flex; flex: 1; overflow: hidden; }
        
        /* Sidebar */
        .sidebar {
            width: 260px;
            background-color: rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            padding: 1rem 0;
            overflow-y: auto;
        }

        .nav-item {
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--text-gray);
            font-weight: 500;
            border-left: 3px solid transparent;
        }
        .nav-item:hover { background-color: rgba(255,255,255,0.05); color: white; }
        .nav-item.active { background-color: rgba(106, 13, 173, 0.2); color: var(--primary-light); border-left-color: var(--primary); }
        .nav-icon { width: 24px; text-align: center; font-size: 1.1rem; }

        /* Main View */
        .main-view {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            background: var(--bg-dark);
            position: relative;
        }

        /* Landing Page */
        .hero-section {
            display: flex; flex-direction: column; align-items: center;
            justify-content: center;
            padding: 4rem 1rem;
            min-height: 100%;
        }
        .hero-content { text-align: center; z-index: 10; }
        .hero-title { font-size: 3rem; font-weight: 800; margin-bottom: 1rem; line-height: 1.1; color: white; }
        .hero-title span { color: var(--primary-light); }
        .hero-desc { color: #ccc; font-size: 1.2rem; margin-bottom: 3rem; max-width: 600px; }

        /* Download Grid */
        .download-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            max-width: 1000px;
            margin: 0 auto;
        }
        .dl-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 2rem;
            border-radius: 16px;
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }
        .dl-card:hover { transform: translateY(-5px); background: rgba(255,255,255,0.1); border-color: var(--primary); }
        .os-title { font-size: 1.2rem; font-weight: 700; color: white; }
        .dl-btn {
            background: var(--primary);
            color: white;
            width: 100%;
            padding: 1rem;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .dl-btn:hover { background: var(--primary-light); }

        /* Tools Grid */
        .tools-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 1rem; }
        .tool-card {
            background: var(--bg-panel);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
            border: 1px solid rgba(255,255,255,0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }
        .tool-card:hover { transform: translateY(-5px); border-color: var(--primary); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        .t-icon { font-size: 2rem; color: var(--primary-light); margin-bottom: 0.5rem; }
        .t-name { font-weight: 600; font-size: 0.95rem; color: white; }

        /* Workspace */
        .workspace {
            display: none;
            height: 100%;
            flex-direction: column;
        }
        .ws-open { display: flex; }

        .ws-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: var(--bg-panel);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .drop-zone {
            border: 2px dashed rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: 0.2s;
            margin-bottom: 2rem;
            background: rgba(255,255,255,0.02);
        }
        .drop-zone:hover { border-color: var(--primary); background: rgba(106, 13, 173, 0.05); }
        .dz-icon { font-size: 2.5rem; color: #666; margin-bottom: 1rem; }

        .file-list { display: flex; gap: 1rem; flex-wrap: wrap; min-height: 100px; }
        .file-item {
            background: rgba(255,255,255,0.1);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            display: flex; align-items: center; gap: 10px;
            font-size: 0.9rem;
            color: white;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .del-file { color: #ef4444; cursor: pointer; font-size: 1.2rem; }

        .action-bar { text-align: center; margin-top: 2rem; }
        .process-btn {
            width: 100%; padding: 1.2rem;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white; border: none; border-radius: 8px;
            font-size: 1.1rem; font-weight: 700; cursor: pointer;
            box-shadow: 0 4px 15px rgba(106,13,173,0.3);
        }

        /* Mobile */
        @media (max-width: 768px) {
            .sidebar { width: 70px; padding: 1rem 0.5rem; }
            .nav-item { padding: 1rem; }
            .nav-item span { display: none; }
            .nav-item i { font-size: 1.4rem; }
            .tools-grid { grid-template-columns: 1fr 1fr; }
            .download-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="app-header">
        <div class="brand-container" onclick="showLanding()">
            <!-- SMALL ICON (Your Design) -->
            <div class="brand-icon brand-icon-sm">
                <div class="icon-box">
                    <span class="icon-text">PDF</span>
                </div>
            </div>
        </div>
        <div style="font-size: 0.8rem; color: var(--text-gray);">
            v1.0 â€¢ 13 Tools
        </div>
    </header>

    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="nav-item active" onclick="filter('all')"><i class="fa-solid fa-grip"></i> <span>All Tools</span></div>
            <div class="nav-item" onclick="filter('org')"><i class="fa-solid fa-layer-group"></i> <span>Organize</span></div>
            <div class="nav-item" onclick="filter('conv')"><i class="fa-solid fa-arrow-right-arrow-left"></i> <span>Convert</span></div>
            <div class="nav-item" onclick="filter('opt')"><i class="fa-solid fa-sliders"></i> <span>Options</span></div>
            <div class="nav-item" onclick="filter('sec')"><i class="fa-solid fa-shield-halved"></i> <span>Security</span></div>
        </nav>

        <!-- Main View -->
        <main class="main-view">
            
            <!-- LANDING PAGE (Website View) -->
            <div id="landingPage" class="hero-section">
                
                <!-- LARGE ICON (Your Design) -->
                <div class="brand-icon brand-icon-lg">
                  <div class="icon-box">
                    <span class="icon-text">PDF</span>
                  </div>
                  <div class="brand-name">BRUTALTOOLS</div>
                  <div class="tagline">All-in-One PDF</div>
                </div>

                <div class="hero-content">
                    <h1 class="hero-title">Ultimate <span>PDF Suite</span></h1>
                    <p class="hero-desc">Works on Windows, Mac, Linux, Android, and iOS.<br>Offline, Secure, and Blazing Fast.</p>
                </div>

                <h2 style="color: var(--primary-light); margin-bottom: 2rem;">Download Native App</h2>
                
                <div class="download-grid">
                    <div class="dl-card" onclick="downloadApp()">
                        <div class="os-title"><i class="fa-brands fa-windows"></i> Windows</div>
                        <button class="dl-btn"><i class="fa-solid fa-download"></i> Download</button>
                    </div>
                    <div class="dl-card" onclick="downloadApp()">
                        <div class="os-title"><i class="fa-brands fa-apple"></i> macOS</div>
                        <button class="dl-btn"><i class="fa-solid fa-download"></i> Download</button>
                    </div>
                    <div class="dl-card" onclick="downloadApp()">
                        <div class="os-title"><i class="fa-brands fa-linux"></i> Linux</div>
                        <button class="dl-btn"><i class="fa-solid fa-download"></i> Download</button>
                    </div>
                    <div class="dl-card" onclick="downloadApp()">
                        <div class="os-title"><i class="fa-brands fa-android"></i> Android</div>
                        <button class="dl-btn"><i class="fa-solid fa-download"></i> Download</button>
                    </div>
                </div>
            </div>

            <!-- WORKSPACE (App View) -->
            <div id="workspace" class="workspace">
                <div class="ws-header">
                    <button onclick="showLanding()" style="background:none; border:none; color:white; font-size:1.5rem; cursor:pointer;"><i class="fa-solid fa-arrow-left"></i></button>
                    <h3 id="wsTitle" style="margin:0; color: white;">Tool</h3>
                </div>
                
                <div style="padding: 2rem;">
                    <div id="editor" style="display:none;">
                        <!-- Dynamic Options Area -->
                        <div id="optionsPanel" style="margin-bottom: 1.5rem;"></div>
                    </div>

                    <div class="drop-zone" id="dropZone" onclick="triggerInput()">
                        <i class="fa-solid fa-cloud-arrow-up dz-icon"></i>
                        <h3>Select File</h3>
                        <input type="file" id="fileInput" multiple style="display:none;">
                    </div>

                    <div id="fileList" class="file-list" style="display:none;"></div>
                    
                    <div id="actionArea" class="action-bar" style="display:none;">
                        <button class="process-btn" onclick="process()">Process & Save</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- 13 TOOLS DATA ---
        const tools = [
            { id: 'merge', cat: 'org', icon: 'fa-layer-group', name: 'Merge PDF' },
            { id: 'split', cat: 'org', icon: 'fa-scissors', name: 'Split PDF' },
            { id: 'rotate', cat: 'org', icon: 'fa-rotate-right', name: 'Rotate PDF' },
            { id: 'pagenumbers', cat: 'org', icon: 'fa-list-ol', name: 'Page Numbers' },
            { id: 'header', cat: 'org', icon: 'fa-heading', name: 'Add Header' },
            { id: 'footer', cat: 'org', icon: 'fa-paragraph', name: 'Add Footer' },
            
            { id: 'img2pdf', cat: 'conv', icon: 'fa-image', name: 'Image to PDF' },
            { id: 'pdf2img', cat: 'conv', icon: 'fa-file-image', name: 'PDF to Image' },
            
            { id: 'compress', cat: 'opt', icon: 'fa-compress', name: 'Compress PDF' },
            { id: 'resize', cat: 'opt', icon: 'fa-expand', name: 'Resize PDF' },
            
            { id: 'watermark', cat: 'sec', icon: 'fa-copyright', name: 'Watermark' },
            { id: 'protect', cat: 'sec', icon: 'fa-lock', name: 'Protect' },
            { id: 'unlock', cat: 'sec', icon: 'fa-unlock', name: 'Unlock' },
            { id: 'sign', cat: 'sec', icon: 'fa-signature', name: 'Sign PDF' }
        ];

        let currentTool = null;
        let files = [];

        // --- NAVIGATION ---
        function showLanding() {
            document.getElementById('landingPage').style.display = 'flex';
            document.getElementById('workspace').classList.remove('ws-open');
            files = [];
        }

        function downloadApp() {
            // Downloads itself
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = "BRUTALTOOLS_Native_App.html";
            document.body.appendChild(a);
            a.click();
            
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert("App downloaded!\n\n1. Open the downloaded .html file.\n2. BRUTALTOOLS will launch as a Native App with YOUR ICON.");
        }

        // --- APP LOGIC ---
        function renderGrid(filter = 'all') {
            const grid = document.getElementById('toolsGrid');
            if(!grid) return; // Prevent crash if in app mode
            
            grid.innerHTML = '';
            const list = filter === 'all' ? tools : tools.filter(t => t.cat === filter);
            list.forEach(t => {
                const card = document.createElement('div');
                card.className = 'tool-card';
                card.innerHTML = `<div class="t-icon"><i class="fa-solid ${t.icon}"></i></div><div class="t-name">${t.name}</div>`;
                card.onclick = () => openTool(t);
                grid.appendChild(card);
            });
        }

        function filter(cat) {
            document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
            event.currentTarget.classList.add('active');
            renderGrid(cat);
        }

        function openTool(tool) {
            currentTool = tool;
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('workspace').classList.add('ws-open');
            document.getElementById('wsTitle').innerText = tool.name;
            
            // Reset UI
            document.getElementById('editor').style.display = 'none';
            document.getElementById('dropZone').style.display = 'block';
            document.getElementById('fileList').style.display = 'none';
            document.getElementById('actionArea').style.display = 'none';
            document.getElementById('optionsPanel').innerHTML = '';
            
            // Dynamic Options
            if(['resize'].includes(tool.id)) {
                document.getElementById('editor').style.display = 'block';
                document.getElementById('optionsPanel').innerHTML = `<input type="number" placeholder="Scale (e.g. 0.5)" style="width:100%; padding:1rem; border-radius:8px; border:none; background:rgba(255,255,255,0.1); color:white;">`;
            } 
            else if(['header','footer'].includes(tool.id)) {
                document.getElementById('editor').style.display = 'block';
                document.getElementById('optionsPanel').innerHTML = `<input type="text" placeholder="Text content..." style="width:100%; padding:1rem; border-radius:8px; border:none; background:rgba(255,255,255,0.1); color:white;">`;
            }
            else if(tool.id === 'sign') {
                 document.getElementById('editor').style.display = 'block';
                 document.getElementById('optionsPanel').innerHTML = `<input type="file" accept="image/*" style="width:100%; color:white;">`;
            }

            if(tool.id === 'img2pdf') document.getElementById('fileInput').accept = 'image/*';
            else document.getElementById('fileInput').accept = '.pdf';
        }

        function triggerInput() { document.getElementById('fileInput').click(); }
        
        document.getElementById('fileInput').addEventListener('change', (e) => {
            files = Array.from(e.target.files);
            if(files.length === 0) return;

            document.getElementById('dropZone').style.display = 'none';
            document.getElementById('editor').style.display = 'block';
            document.getElementById('fileList').style.display = 'flex';
            document.getElementById('actionArea').style.display = 'block';

            const list = document.getElementById('fileList');
            list.innerHTML = '';

            files.forEach(f => {
                const div = document.createElement('div');
                div.className = 'file-item';
                div.innerHTML = `<i class="fa-solid fa-file-pdf"></i> ${f.name} <i class="fa-solid fa-times del-file"></i>`;
                div.querySelector('.del-file').onclick = () => { 
                    div.remove(); 
                    files = files.filter(x => x !== f); 
                };
                list.appendChild(div);
            });
        });

        // --- PROCESSING ---
        async function process() {
            if(files.length === 0) return alert("Please select a file first.");
            
            const btn = document.querySelector('.process-btn');
            const originalText = btn.innerText;
            btn.innerText = "Processing...";
            btn.disabled = true;

            try {
                const { PDFDocument, rgb, degrees, StandardFonts } = PDFLib;
                let result;

                if(currentTool.id === 'merge') {
                    const merged = await PDFDocument.create();
                    for(let f of files) {
                        const src = await PDFDocument.load(await f.arrayBuffer());
                        const pages = await merged.copyPages(src, src.getPageIndices());
                        pages.forEach(p => merged.addPage(p));
                    }
                    result = await merged.save();
                }
                else if(currentTool.id === 'compress') {
                    const src = await PDFDocument.load(await files[0].arrayBuffer());
                    result = await src.save({ useObjectStreams: true });
                }
                else if(currentTool.id === 'img2pdf') {
                    const doc = await PDFDocument.create();
                    for(let f of files) {
                        let img = f.type === 'image/jpeg' ? await doc.drawJpg(await f.arrayBuffer()) : await doc.drawPng(await f.arrayBuffer());
                        const page = doc.addPage();
                        page.drawImage(img, { x: 0, y: 0, width: page.getWidth(), height: page.getHeight() });
                    }
                    result = await doc.save();
                }
                else if(currentTool.id === 'resize') {
                    const scale = parseFloat(document.querySelector('#optionsPanel input').value) || 0.8;
                    const src = await PDFDocument.load(await files[0].arrayBuffer());
                    const pages = src.getPages();
                    for(let i=0; i<pages.length; i++) {
                        const { width, height } = pages[i].getSize();
                        pages[i].setWidth(width * scale);
                        pages[i].setHeight(height * scale);
                    }
                    result = await src.save();
                }
                else if(currentTool.id === 'watermark') {
                    const src = await PDFDocument.load(await files[0].arrayBuffer());
                    const font = await src.embedFont(StandardFonts.HelveticaBold);
                    src.getPages().forEach(page => {
                        const { width, height } = page.getSize();
                        page.drawText("BRUTALTOOLS", { x: width/2 - 40, y: height/2, size: 50, font, color: rgb(0.9,0.9,0.9), opacity: 0.3, rotate: degrees(45) });
                    });
                    result = await src.save();
                }
                else if(currentTool.id === 'protect') {
                    const src = await PDFDocument.load(await files[0].arrayBuffer());
                    result = await src.save({ userPassword: "1234" }); // Demo password
                }
                else if(currentTool.id === 'header') {
                    const text = document.querySelector('#optionsPanel input').value;
                    const src = await PDFDocument.load(await files[0].arrayBuffer());
                    const font = await src.embedFont(StandardFonts.Helvetica);
                    src.getPages().forEach(page => {
                        page.drawText(text, { x: 50, y: page.getHeight() - 40, size: 20, font, color: rgb(1,1,1) });
                    });
                    result = await src.save();
                }

                // Native Save
                const blob = new Blob([result], {type: 'application/pdf'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Brutal_${currentTool.id}.pdf`;
                a.click();
                
                btn.innerText = "Saved!";
                setTimeout(() => { btn.innerText = originalText; btn.disabled = false; }, 2000);

            } catch(e) {
                alert("Error: " + e.message);
                btn.innerText = originalText;
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
